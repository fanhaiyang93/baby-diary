---
layout: page
title: æ—¥è®°æ—¥å¿—
description: è®°å½•å­•æœŸçš„ç‚¹ç‚¹æ»´æ»´ï¼Œçè—ç¾å¥½æ—¶å…‰
---

<div class="diary-page">
    <!-- æ—¥è®°æ¦‚è§ˆ -->
    <section class="diary-overview">
        <div class="overview-cards">
            <div class="overview-card">
                <div class="card-icon">ğŸ“</div>
                <div class="card-content">
                    <div class="card-number" id="total-entries">28</div>
                    <div class="card-label">æ—¥è®°ç¯‡æ•°</div>
                </div>
            </div>
            <div class="overview-card">
                <div class="card-icon">ğŸ’­</div>
                <div class="card-content">
                    <div class="card-number" id="total-words">15,680</div>
                    <div class="card-label">æ€»å­—æ•°</div>
                </div>
            </div>
            <div class="overview-card">
                <div class="card-icon">â¤ï¸</div>
                <div class="card-content">
                    <div class="card-number" id="favorite-entries">8</div>
                    <div class="card-label">æ”¶è—æ—¥è®°</div>
                </div>
            </div>
            <div class="overview-card">
                <div class="card-icon">ğŸ“…</div>
                <div class="card-content">
                    <div class="card-number" id="writing-days">25</div>
                    <div class="card-label">è®°å½•å¤©æ•°</div>
                </div>
            </div>
        </div>
    </section>

    <!-- æ—¥è®°ç­›é€‰ -->
    <section class="diary-filters">
        <div class="filter-group">
            <div class="filter-tabs">
                <button class="filter-tab active" data-filter="all">å…¨éƒ¨æ—¥è®°</button>
                <button class="filter-tab" data-filter="mood">å¿ƒæƒ…è®°å½•</button>
                <button class="filter-tab" data-filter="checkup">äº§æ£€æ—¥è®°</button>
                <button class="filter-tab" data-filter="milestone">é‡Œç¨‹ç¢‘</button>
                <button class="filter-tab" data-filter="daily">æ—¥å¸¸ç”Ÿæ´»</button>
                <button class="filter-tab" data-filter="favorite">æˆ‘çš„æ”¶è—</button>
            </div>
            <div class="filter-controls">
                <div class="search-box">
                    <input type="text" id="diary-search" placeholder="æœç´¢æ—¥è®°å†…å®¹...">
                    <span class="search-icon">ğŸ”</span>
                </div>
                <div class="sort-dropdown">
                    <select id="diary-sort">
                        <option value="date-desc">æœ€æ–°ä¼˜å…ˆ</option>
                        <option value="date-asc">æœ€æ—©ä¼˜å…ˆ</option>
                        <option value="words-desc">å­—æ•°æœ€å¤š</option>
                        <option value="words-asc">å­—æ•°æœ€å°‘</option>
                    </select>
                </div>
                <div class="view-toggle">
                    <button class="view-btn active" data-view="card">ğŸ“‹</button>
                    <button class="view-btn" data-view="list">ğŸ“„</button>
                </div>
            </div>
        </div>
    </section>

    <!-- æ—¥è®°åˆ—è¡¨ -->
    <section class="diary-list">
        <div class="diary-grid" id="diary-grid">
            <!-- æ—¥è®°æ¡ç›® 1 -->
            <article class="diary-entry" data-category="milestone" data-date="2024-01-15" data-words="320">
                <div class="entry-header">
                    <div class="entry-date">
                        <span class="date-day">15</span>
                        <span class="date-month">1æœˆ</span>
                    </div>
                    <div class="entry-meta">
                        <span class="entry-week">ç¬¬20å‘¨</span>
                        <span class="entry-category milestone">é‡Œç¨‹ç¢‘</span>
                    </div>
                    <div class="entry-actions">
                        <button class="action-btn favorite" onclick="toggleFavorite(this)">
                            <span class="action-icon">ğŸ¤</span>
                        </button>
                        <button class="action-btn share" onclick="shareEntry(this)">
                            <span class="action-icon">ğŸ“¤</span>
                        </button>
                        <button class="action-btn more" onclick="showEntryMenu(this)">
                            <span class="action-icon">â‹¯</span>
                        </button>
                    </div>
                </div>
                <div class="entry-content">
                    <h3 class="entry-title">ç¬¬ä¸€æ¬¡æ„Ÿå—åˆ°èƒåŠ¨</h3>
                    <div class="entry-excerpt">
                        ä»Šå¤©æ˜¯ä¸ªç‰¹åˆ«çš„æ—¥å­ï¼ä¸‹åˆåœ¨åŠå…¬å®¤å·¥ä½œæ—¶ï¼Œçªç„¶æ„Ÿå—åˆ°äº†å®å®çš„ç¬¬ä¸€æ¬¡èƒåŠ¨ã€‚é‚£ç§æ„Ÿè§‰å°±åƒå°é±¼åœ¨æ¸¸æ³³ï¼Œè½»æŸ”è€Œç¥å¥‡ã€‚å½“æ—¶æˆ‘æ¿€åŠ¨å¾—å·®ç‚¹å“­å‡ºæ¥ï¼Œç«‹åˆ»ç»™è€å…¬å‘äº†æ¶ˆæ¯...
                    </div>
                    <div class="entry-tags">
                        <span class="tag">#èƒåŠ¨</span>
                        <span class="tag">#ç¬¬ä¸€æ¬¡</span>
                        <span class="tag">#æ¿€åŠ¨</span>
                    </div>
                </div>
                <div class="entry-footer">
                    <div class="entry-stats">
                        <span class="stat">ğŸ“ 320å­—</span>
                        <span class="stat">â±ï¸ 2åˆ†é’Ÿ</span>
                        <span class="stat">ğŸ‘€ 15æ¬¡</span>
                    </div>
                    <div class="entry-mood">
                        <span class="mood-emoji">ğŸ˜Š</span>
                        <span class="mood-text">å¼€å¿ƒ</span>
                    </div>
                </div>
            </article>

            <!-- æ—¥è®°æ¡ç›® 2 -->
            <article class="diary-entry" data-category="checkup" data-date="2024-01-12" data-words="280">
                <div class="entry-header">
                    <div class="entry-date">
                        <span class="date-day">12</span>
                        <span class="date-month">1æœˆ</span>
                    </div>
                    <div class="entry-meta">
                        <span class="entry-week">ç¬¬19å‘¨</span>
                        <span class="entry-category checkup">äº§æ£€æ—¥è®°</span>
                    </div>
                    <div class="entry-actions">
                        <button class="action-btn favorite" onclick="toggleFavorite(this)">
                            <span class="action-icon">â¤ï¸</span>
                        </button>
                        <button class="action-btn share" onclick="shareEntry(this)">
                            <span class="action-icon">ğŸ“¤</span>
                        </button>
                        <button class="action-btn more" onclick="showEntryMenu(this)">
                            <span class="action-icon">â‹¯</span>
                        </button>
                    </div>
                </div>
                <div class="entry-content">
                    <h3 class="entry-title">ç¬¬å››æ¬¡äº§æ£€è®°å½•</h3>
                    <div class="entry-excerpt">
                        ä»Šå¤©å»åŒ»é™¢åšäº†ç¬¬å››æ¬¡äº§æ£€ï¼Œä¸€åˆ‡éƒ½å¾ˆé¡ºåˆ©ï¼å®å®çš„å„é¡¹æŒ‡æ ‡éƒ½æ­£å¸¸ï¼Œä½“é‡å¢é•¿ä¹Ÿåœ¨åˆç†èŒƒå›´å†…ã€‚åŒ»ç”Ÿè¯´å®å®å¾ˆå¥åº·ï¼Œè®©æˆ‘ä»¬å¾ˆå®‰å¿ƒã€‚è¿™æ¬¡è¿˜åšäº†å››ç»´å½©è¶…...
                    </div>
                    <div class="entry-tags">
                        <span class="tag">#äº§æ£€</span>
                        <span class="tag">#å››ç»´å½©è¶…</span>
                        <span class="tag">#å¥åº·</span>
                    </div>
                </div>
                <div class="entry-footer">
                    <div class="entry-stats">
                        <span class="stat">ğŸ“ 280å­—</span>
                        <span class="stat">â±ï¸ 2åˆ†é’Ÿ</span>
                        <span class="stat">ğŸ‘€ 8æ¬¡</span>
                    </div>
                    <div class="entry-mood">
                        <span class="mood-emoji">ğŸ˜Œ</span>
                        <span class="mood-text">å®‰å¿ƒ</span>
                    </div>
                </div>
            </article>

            <!-- æ—¥è®°æ¡ç›® 3 -->
            <article class="diary-entry" data-category="daily" data-date="2024-01-10" data-words="450">
                <div class="entry-header">
                    <div class="entry-date">
                        <span class="date-day">10</span>
                        <span class="date-month">1æœˆ</span>
                    </div>
                    <div class="entry-meta">
                        <span class="entry-week">ç¬¬19å‘¨</span>
                        <span class="entry-category daily">æ—¥å¸¸ç”Ÿæ´»</span>
                    </div>
                    <div class="entry-actions">
                        <button class="action-btn favorite" onclick="toggleFavorite(this)">
                            <span class="action-icon">ğŸ¤</span>
                        </button>
                        <button class="action-btn share" onclick="shareEntry(this)">
                            <span class="action-icon">ğŸ“¤</span>
                        </button>
                        <button class="action-btn more" onclick="showEntryMenu(this)">
                            <span class="action-icon">â‹¯</span>
                        </button>
                    </div>
                </div>
                <div class="entry-content">
                    <h3 class="entry-title">å­•æœŸç‘œä¼½åˆä½“éªŒ</h3>
                    <div class="entry-excerpt">
                        ä»Šå¤©ç¬¬ä¸€æ¬¡å°è¯•å­•æœŸç‘œä¼½è¯¾ç¨‹ï¼Œæ„Ÿè§‰çœŸçš„å¾ˆæ£’ï¼æ•™ç»ƒå¾ˆä¸“ä¸šï¼ŒåŠ¨ä½œéƒ½æ˜¯é’ˆå¯¹å­•å¦‡è®¾è®¡çš„ï¼Œæ—¢èƒ½é”»ç‚¼èº«ä½“åˆå¾ˆå®‰å…¨ã€‚è¯¾ç¨‹ç»“æŸåæ„Ÿè§‰èº«å¿ƒéƒ½å¾ˆæ”¾æ¾ï¼Œè…°èƒŒç–¼ç—›ä¹Ÿç¼“è§£äº†ä¸å°‘...
                    </div>
                    <div class="entry-tags">
                        <span class="tag">#å­•æœŸç‘œä¼½</span>
                        <span class="tag">#è¿åŠ¨</span>
                        <span class="tag">#æ”¾æ¾</span>
                    </div>
                </div>
                <div class="entry-footer">
                    <div class="entry-stats">
                        <span class="stat">ğŸ“ 450å­—</span>
                        <span class="stat">â±ï¸ 3åˆ†é’Ÿ</span>
                        <span class="stat">ğŸ‘€ 12æ¬¡</span>
                    </div>
                    <div class="entry-mood">
                        <span class="mood-emoji">ğŸ˜„</span>
                        <span class="mood-text">æ„‰å¿«</span>
                    </div>
                </div>
            </article>

            <!-- æ—¥è®°æ¡ç›® 4 -->
            <article class="diary-entry" data-category="mood" data-date="2024-01-08" data-words="380">
                <div class="entry-header">
                    <div class="entry-date">
                        <span class="date-day">08</span>
                        <span class="date-month">1æœˆ</span>
                    </div>
                    <div class="entry-meta">
                        <span class="entry-week">ç¬¬19å‘¨</span>
                        <span class="entry-category mood">å¿ƒæƒ…è®°å½•</span>
                    </div>
                    <div class="entry-actions">
                        <button class="action-btn favorite" onclick="toggleFavorite(this)">
                            <span class="action-icon">ğŸ¤</span>
                        </button>
                        <button class="action-btn share" onclick="shareEntry(this)">
                            <span class="action-icon">ğŸ“¤</span>
                        </button>
                        <button class="action-btn more" onclick="showEntryMenu(this)">
                            <span class="action-icon">â‹¯</span>
                        </button>
                    </div>
                </div>
                <div class="entry-content">
                    <h3 class="entry-title">å¯¹æœªæ¥çš„æ†§æ†¬ä¸æ‹…å¿§</h3>
                    <div class="entry-excerpt">
                        æœ€è¿‘æ€»æ˜¯åœ¨æƒ³è±¡å®å®å‡ºç”Ÿåçš„ç”Ÿæ´»ä¼šæ˜¯ä»€ä¹ˆæ ·å­ã€‚æœ‰æ—¶å€™å……æ»¡æœŸå¾…ï¼Œæƒ³è±¡ç€æŠ±ç€å®å®çš„æ¸©é¦¨ç”»é¢ï¼›æœ‰æ—¶å€™åˆä¼šæ‹…å¿ƒï¼Œæ‹…å¿ƒè‡ªå·±èƒ½ä¸èƒ½åšä¸ªå¥½å¦ˆå¦ˆï¼Œæ‹…å¿ƒå·¥ä½œå’Œè‚²å„¿çš„å¹³è¡¡...
                    </div>
                    <div class="entry-tags">
                        <span class="tag">#å¿ƒæƒ…</span>
                        <span class="tag">#æœŸå¾…</span>
                        <span class="tag">#æ‹…å¿§</span>
                    </div>
                </div>
                <div class="entry-footer">
                    <div class="entry-stats">
                        <span class="stat">ğŸ“ 380å­—</span>
                        <span class="stat">â±ï¸ 3åˆ†é’Ÿ</span>
                        <span class="stat">ğŸ‘€ 6æ¬¡</span>
                    </div>
                    <div class="entry-mood">
                        <span class="mood-emoji">ğŸ¤”</span>
                        <span class="mood-text">å¤æ‚</span>
                    </div>
                </div>
            </article>

            <!-- æ—¥è®°æ¡ç›® 5 -->
            <article class="diary-entry" data-category="milestone" data-date="2024-01-05" data-words="520">
                <div class="entry-header">
                    <div class="entry-date">
                        <span class="date-day">05</span>
                        <span class="date-month">1æœˆ</span>
                    </div>
                    <div class="entry-meta">
                        <span class="entry-week">ç¬¬18å‘¨</span>
                        <span class="entry-category milestone">é‡Œç¨‹ç¢‘</span>
                    </div>
                    <div class="entry-actions">
                        <button class="action-btn favorite active" onclick="toggleFavorite(this)">
                            <span class="action-icon">â¤ï¸</span>
                        </button>
                        <button class="action-btn share" onclick="shareEntry(this)">
                            <span class="action-icon">ğŸ“¤</span>
                        </button>
                        <button class="action-btn more" onclick="showEntryMenu(this)">
                            <span class="action-icon">â‹¯</span>
                        </button>
                    </div>
                </div>
                <div class="entry-content">
                    <h3 class="entry-title">å®å®æ€§åˆ«æ­æ™“</h3>
                    <div class="entry-excerpt">
                        ä»Šå¤©ç»ˆäºçŸ¥é“å®å®çš„æ€§åˆ«äº†ï¼æ˜¯ä¸ªå°å…¬ä¸»ï¼å½“åŒ»ç”Ÿå‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªæ¶ˆæ¯æ—¶ï¼Œæˆ‘å’Œè€å…¬éƒ½æ¿€åŠ¨å¾—ä¸è¡Œã€‚è™½ç„¶ä¹‹å‰è¯´ç”·å­©å¥³å­©éƒ½å¥½ï¼Œä½†çŸ¥é“æ˜¯å¥³å„¿åï¼Œå¿ƒé‡Œæ¶Œèµ·äº†ç‰¹åˆ«çš„æ¸©æŸ”...
                    </div>
                    <div class="entry-tags">
                        <span class="tag">#æ€§åˆ«æ­æ™“</span>
                        <span class="tag">#å¥³å„¿</span>
                        <span class="tag">#æ¿€åŠ¨</span>
                    </div>
                </div>
                <div class="entry-footer">
                    <div class="entry-stats">
                        <span class="stat">ğŸ“ 520å­—</span>
                        <span class="stat">â±ï¸ 4åˆ†é’Ÿ</span>
                        <span class="stat">ğŸ‘€ 25æ¬¡</span>
                    </div>
                    <div class="entry-mood">
                        <span class="mood-emoji">ğŸ¥°</span>
                        <span class="mood-text">å¹¸ç¦</span>
                    </div>
                </div>
            </article>

            <!-- æ—¥è®°æ¡ç›® 6 -->
            <article class="diary-entry" data-category="daily" data-date="2024-01-03" data-words="290">
                <div class="entry-header">
                    <div class="entry-date">
                        <span class="date-day">03</span>
                        <span class="date-month">1æœˆ</span>
                    </div>
                    <div class="entry-meta">
                        <span class="entry-week">ç¬¬18å‘¨</span>
                        <span class="entry-category daily">æ—¥å¸¸ç”Ÿæ´»</span>
                    </div>
                    <div class="entry-actions">
                        <button class="action-btn favorite" onclick="toggleFavorite(this)">
                            <span class="action-icon">ğŸ¤</span>
                        </button>
                        <button class="action-btn share" onclick="shareEntry(this)">
                            <span class="action-icon">ğŸ“¤</span>
                        </button>
                        <button class="action-btn more" onclick="showEntryMenu(this)">
                            <span class="action-icon">â‹¯</span>
                        </button>
                    </div>
                </div>
                <div class="entry-content">
                    <h3 class="entry-title">æ–°å¹´ç¬¬ä¸€æ¬¡é€›å©´å„¿ç”¨å“åº—</h3>
                    <div class="entry-excerpt">
                        æ–°å¹´ç¬¬ä¸€å¤©ï¼Œæˆ‘å’Œè€å…¬å»é€›äº†å©´å„¿ç”¨å“åº—ã€‚çœ‹åˆ°é‚£äº›å°å°çš„è¡£æœã€é‹å­å’Œç©å…·ï¼Œå¿ƒé‡Œæ»¡æ»¡çš„éƒ½æ˜¯æœŸå¾…ã€‚è™½ç„¶è¿˜æ—©ï¼Œä½†å¿ä¸ä½ä¹°äº†å‡ ä»¶å°è¡£æœï¼Œæƒ³è±¡ç€å®å®ç©¿ä¸Šçš„æ ·å­...
                    </div>
                    <div class="entry-tags">
                        <span class="tag">#è´­ç‰©</span>
                        <span class="tag">#å©´å„¿ç”¨å“</span>
                        <span class="tag">#æœŸå¾…</span>
                    </div>
                </div>
                <div class="entry-footer">
                    <div class="entry-stats">
                        <span class="stat">ğŸ“ 290å­—</span>
                        <span class="stat">â±ï¸ 2åˆ†é’Ÿ</span>
                        <span class="stat">ğŸ‘€ 10æ¬¡</span>
                    </div>
                    <div class="entry-mood">
                        <span class="mood-emoji">ğŸ˜</span>
                        <span class="mood-text">å…´å¥‹</span>
                    </div>
                </div>
            </article>
        </div>

        <!-- åŠ è½½æ›´å¤š -->
        <div class="load-more-section">
            <button class="load-more-btn" onclick="loadMoreEntries()">
                <span class="load-icon">â¬‡ï¸</span>
                <span class="load-text">åŠ è½½æ›´å¤šæ—¥è®°</span>
            </button>
        </div>
    </section>

    <!-- å†™æ—¥è®°æµ®åŠ¨æŒ‰é’® -->
    <div class="write-fab" onclick="showWriteModal()">
        <span class="fab-icon">âœï¸</span>
        <span class="fab-text">å†™æ—¥è®°</span>
    </div>

    <!-- å†™æ—¥è®°æ¨¡æ€æ¡† -->
    <div class="write-modal" id="write-modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">å†™æ—¥è®°</h3>
                <button class="modal-close" onclick="closeWriteModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form class="write-form" id="write-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="entry-title">æ—¥è®°æ ‡é¢˜</label>
                            <input type="text" id="entry-title" placeholder="ç»™è¿™ç¯‡æ—¥è®°èµ·ä¸ªæ ‡é¢˜...">
                        </div>
                        <div class="form-group">
                            <label for="entry-category">åˆ†ç±»</label>
                            <select id="entry-category">
                                <option value="daily">æ—¥å¸¸ç”Ÿæ´»</option>
                                <option value="mood">å¿ƒæƒ…è®°å½•</option>
                                <option value="checkup">äº§æ£€æ—¥è®°</option>
                                <option value="milestone">é‡Œç¨‹ç¢‘</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="entry-date">æ—¥æœŸ</label>
                            <input type="date" id="entry-date">
                        </div>
                        <div class="form-group">
                            <label for="entry-week">å­•å‘¨</label>
                            <input type="number" id="entry-week" min="1" max="42" placeholder="ç¬¬å‡ å‘¨">
                        </div>
                        <div class="form-group">
                            <label for="entry-mood">å¿ƒæƒ…</label>
                            <select id="entry-mood">
                                <option value="happy">ğŸ˜Š å¼€å¿ƒ</option>
                                <option value="excited">ğŸ˜ å…´å¥‹</option>
                                <option value="peaceful">ğŸ˜Œ å¹³é™</option>
                                <option value="worried">ğŸ˜Ÿ æ‹…å¿ƒ</option>
                                <option value="tired">ğŸ˜´ ç–²æƒ«</option>
                                <option value="complex">ğŸ¤” å¤æ‚</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group full-width">
                        <label for="entry-content">æ—¥è®°å†…å®¹</label>
                        <textarea id="entry-content" rows="10" placeholder="è®°å½•ä»Šå¤©çš„å¿ƒæƒ…å’Œæ„Ÿå—..."></textarea>
                        <div class="content-stats">
                            <span id="word-count">0</span> å­—
                        </div>
                    </div>
                    <div class="form-group full-width">
                        <label for="entry-tags">æ ‡ç­¾</label>
                        <input type="text" id="entry-tags" placeholder="ç”¨ç©ºæ ¼åˆ†éš”å¤šä¸ªæ ‡ç­¾ï¼Œå¦‚ï¼šèƒåŠ¨ ç¬¬ä¸€æ¬¡ æ¿€åŠ¨">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="form-btn cancel" onclick="closeWriteModal()">å–æ¶ˆ</button>
                        <button type="button" class="form-btn save-draft" onclick="saveDraft()">ä¿å­˜è‰ç¨¿</button>
                        <button type="button" class="form-btn submit" onclick="submitEntry()">å‘å¸ƒæ—¥è®°</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
/* æ—¥è®°é¡µé¢æ ·å¼ */
.diary-page {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

/* æ¦‚è§ˆå¡ç‰‡ */
.diary-overview {
    margin-bottom: 30px;
}

.overview-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
}

.overview-card {
    background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
    border-radius: 15px;
    padding: 25px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    border: 1px solid #f0f0f0;
    display: flex;
    align-items: center;
    gap: 20px;
    transition: all 0.3s ease;
}

.overview-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
}

.card-icon {
    font-size: 2.5rem;
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #ff69b4, #ff1493);
    border-radius: 50%;
    color: white;
    box-shadow: 0 4px 15px rgba(255, 105, 180, 0.3);
}

.card-content {
    flex: 1;
}

.card-number {
    font-size: 2rem;
    font-weight: 700;
    color: #2d3748;
    margin-bottom: 5px;
}

.card-label {
    color: #666;
    font-size: 0.9rem;
    font-weight: 500;
}

/* ç­›é€‰å™¨ */
.diary-filters {
    background: white;
    border-radius: 15px;
    padding: 25px;
    margin-bottom: 30px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    border: 1px solid #f0f0f0;
}

.filter-group {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.filter-tabs {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.filter-tab {
    padding: 10px 20px;
    border: 2px solid #f0f0f0;
    background: white;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
    color: #666;
}

.filter-tab:hover {
    border-color: #ff69b4;
    color: #ff1493;
}

.filter-tab.active {
    background: linear-gradient(135deg, #ff69b4, #ff1493);
    color: white;
    border-color: transparent;
}

.filter-controls {
    display: flex;
    gap: 15px;
    align-items: center;
    flex-wrap: wrap;
}

.search-box {
    position: relative;
    flex: 1;
    min-width: 250px;
}

.search-box input {
    width: 100%;
    padding: 12px 45px 12px 15px;
    border: 2px solid #f0f0f0;
    border-radius: 25px;
    font-size: 0.9rem;
    transition: all 0.3s ease;
}

.search-box input:focus {
    outline: none;
    border-color: #ff69b4;
    box-shadow: 0 0 0 3px rgba(255, 105, 180, 0.1);
}

.search-icon {
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    color: #999;
    font-size: 1.1rem;
}

.sort-dropdown select {
    padding: 12px 15px;
    border: 2px solid #f0f0f0;
    border-radius: 25px;
    background: white;
    cursor: pointer;
    font-size: 0.9rem;
    color: #666;
}

.view-toggle {
    display: flex;
    gap: 5px;
    background: #f8f9fa;
    border-radius: 25px;
    padding: 5px;
}

.view-btn {
    padding: 8px 12px;
    border: none;
    background: transparent;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1.1rem;
}

.view-btn.active {
    background: white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* æ—¥è®°åˆ—è¡¨ */
.diary-list {
    margin-bottom: 30px;
}

.diary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
    gap: 25px;
    margin-bottom: 30px;
}

.diary-entry {
    background: white;
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    border: 1px solid #f0f0f0;
    transition: all 0.3s ease;
    cursor: pointer;
}

.diary-entry:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
}

.entry-header {
    display: flex;
    align-items: center;
    padding: 20px 25px 15px;
    border-bottom: 1px solid #f8f9fa;
}

.entry-date {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-right: 20px;
    min-width: 50px;
}

.date-day {
    font-size: 1.8rem;
    font-weight: 700;
    color: #ff1493;
    line-height: 1;
}

.date-month {
    font-size: 0.8rem;
    color: #666;
    font-weight: 500;
}

.entry-meta {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.entry-week {
    font-size: 0.9rem;
    color: #666;
    font-weight: 500;
}

.entry-category {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 15px;
    font-size: 0.8rem;
    font-weight: 500;
    width: fit-content;
}

.entry-category.milestone {
    background: linear-gradient(135deg, #ffd700, #ffb347);
    color: #8b4513;
}

.entry-category.checkup {
    background: linear-gradient(135deg, #87ceeb, #4682b4);
    color: #2f4f4f;
}

.entry-category.daily {
    background: linear-gradient(135deg, #98fb98, #32cd32);
    color: #006400;
}

.entry-category.mood {
    background: linear-gradient(135deg, #dda0dd, #9370db);
    color: #4b0082;
}

.entry-actions {
    display: flex;
    gap: 8px;
}

.action-btn {
    width: 35px;
    height: 35px;
    border: none;
    background: #f8f9fa;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    font-size: 1rem;
}

.action-btn:hover {
    background: #ff69b4;
    color: white;
    transform: scale(1.1);
}

.action-btn.favorite.active {
    background: linear-gradient(135deg, #ff69b4, #ff1493);
    color: white;
}

.entry-content {
    padding: 0 25px 15px;
}

.entry-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: #2d3748;
    margin-bottom: 10px;
    line-height: 1.4;
}

.entry-excerpt {
    color: #555;
    line-height: 1.6;
    margin-bottom: 15px;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.entry-tags {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.tag {
    background: #f8f9fa;
    color: #666;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 500;
}

.entry-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 25px 20px;
    border-top: 1px solid #f8f9fa;
}

.entry-stats {
    display: flex;
    gap: 15px;
}

.stat {
    font-size: 0.8rem;
    color: #666;
    display: flex;
    align-items: center;
    gap: 4px;
}

.entry-mood {
    display: flex;
    align-items: center;
    gap: 8px;
}

.mood-emoji {
    font-size: 1.2rem;
}

.mood-text {
    font-size: 0.9rem;
    color: #666;
    font-weight: 500;
}

/* åŠ è½½æ›´å¤š */
.load-more-section {
    text-align: center;
    padding: 20px;
}

.load-more-btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 15px 30px;
    background: linear-gradient(135deg, #ff69b4, #ff1493);
    color: white;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(255, 105, 180, 0.3);
}

.load-more-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(255, 105, 180, 0.4);
}

.load-icon {
    font-size: 1.1rem;
}

/* å†™æ—¥è®°æµ®åŠ¨æŒ‰é’® */
.write-fab {
    position: fixed;
    bottom: 30px;
    right: 30px;
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #ff69b4, #ff1493);
    border-radius: 50%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 8px 25px rgba(255, 105, 180, 0.4);
    transition: all 0.3s ease;
    z-index: 1000;
    color: white;
}

.write-fab:hover {
    transform: scale(1.1);
    box-shadow: 0 12px 30px rgba(255, 105, 180, 0.5);
}

.fab-icon {
    font-size: 1.5rem;
    margin-bottom: 2px;
}

.fab-text {
    font-size: 0.7rem;
    font-weight: 500;
}

/* å†™æ—¥è®°æ¨¡æ€æ¡† */
.write-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.write-modal.show {
    opacity: 1;
}

.modal-content {
    background: white;
    border-radius: 15px;
    width: 90%;
    max-width: 800px;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 25px;
    border-bottom: 1px solid #f0f0f0;
}

.modal-title {
    font-size: 1.5rem;
    font-weight: 600;
    color: #2d3748;
    margin: 0;
}

.modal-close {
    background: none;
    border: none;
    font-size: 1.5rem;
    color: #666;
    cursor: pointer;
    padding: 5px;
    border-radius: 50%;
    transition: all 0.3s ease;
}

.modal-close:hover {
    background: #f8f9fa;
    color: #333;
}

.modal-body {
    padding: 25px;
}

.write-form {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.form-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.form-group.full-width {
    grid-column: 1 / -1;
}

.form-group label {
    font-weight: 500;
    color: #2d3748;
    font-size: 0.9rem;
}

.form-group input,
.form-group select,
.form-group textarea {
    padding: 12px 15px;
    border: 2px solid #f0f0f0;
    border-radius: 10px;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    font-family: inherit;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #ff69b4;
    box-shadow: 0 0 0 3px rgba(255, 105, 180, 0.1);
}

.form-group textarea {
    resize: vertical;
    min-height: 200px;
}

.content-stats {
    text-align: right;
    font-size: 0.8rem;
    color: #666;
    margin-top: 5px;
}

.form-actions {
    display: flex;
    gap: 15px;
    justify-content: flex-end;
    padding-top: 20px;
    border-top: 1px solid #f0f0f0;
}

.form-btn {
    padding: 12px 25px;
    border: 2px solid #ddd;
    border-radius: 25px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.3s ease;
    background: white;
    color: #666;
}

.form-btn:hover {
    transform: translateY(-2px);
}

.form-btn.cancel {
    border-color: #ddd;
    color: #666;
}

.form-btn.cancel:hover {
    border-color: #999;
    color: #333;
}

.form-btn.save-draft {
    border-color: #ffa500;
    color: #ff8c00;
}

.form-btn.save-draft:hover {
    background: #ffa500;
    color: white;
}

.form-btn.submit {
    background: linear-gradient(135deg, #ff69b4, #ff1493);
    border-color: transparent;
    color: white;
}

.form-btn.submit:hover {
    box-shadow: 0 4px 15px rgba(255, 105, 180, 0.3);
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    .diary-page {
        padding: 15px;
    }
    
    .overview-cards {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
    }
    
    .overview-card {
        padding: 20px;
    }
    
    .card-icon {
        width: 50px;
        height: 50px;
        font-size: 2rem;
    }
    
    .card-number {
        font-size: 1.5rem;
    }
    
    .filter-group {
        gap: 15px;
    }
    
    .filter-controls {
        flex-direction: column;
        align-items: stretch;
    }
    
    .search-box {
        min-width: auto;
    }
    
    .diary-grid {
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    .entry-header {
        padding: 15px 20px 10px;
    }
    
    .entry-content {
        padding: 0 20px 10px;
    }
    
    .entry-footer {
        padding: 10px 20px 15px;
        flex-direction: column;
        gap: 10px;
        align-items: flex-start;
    }
    
    .write-fab {
        width: 50px;
        height: 50px;
        bottom: 20px;
        right: 20px;
    }
    
    .fab-icon {
        font-size: 1.2rem;
    }
    
    .fab-text {
        font-size: 0.6rem;
    }
    
    .modal-content {
        width: 95%;
        margin: 20px;
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .form-actions {
        flex-direction: column;
    }
}
</style>

<script>
// é¡µé¢åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    initDiaryPage();
    initFilters();
    initSearch();
    initWriteForm();
    observeDiaryEntries();
    updateDiaryStats();
});

// åˆå§‹åŒ–æ—¥è®°é¡µé¢
function initDiaryPage() {
    console.log('æ—¥è®°é¡µé¢åˆå§‹åŒ–å®Œæˆ');
}

// åˆå§‹åŒ–ç­›é€‰å™¨
function initFilters() {
    const filterTabs = document.querySelectorAll('.filter-tab');
    const sortSelect = document.getElementById('diary-sort');
    const viewBtns = document.querySelectorAll('.view-btn');
    
    // åˆ†ç±»ç­›é€‰
    filterTabs.forEach(tab => {
        tab.addEventListener('click', function() {
            filterTabs.forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            
            const filter = this.dataset.filter;
            filterEntries(filter);
        });
    });
    
    // æ’åº
    if (sortSelect) {
        sortSelect.addEventListener('change', function() {
            sortEntries(this.value);
        });
    }
    
    // è§†å›¾åˆ‡æ¢
    viewBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            viewBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            const view = this.dataset.view;
            switchView(view);
        });
    });
}

// åˆå§‹åŒ–æœç´¢
function initSearch() {
    const searchInput = document.getElementById('diary-search');
    
    if (searchInput) {
        let searchTimeout;
        searchInput.addEventListener('input', function() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                searchEntries(this.value);
            }, 300);
        });
    }
}

// åˆå§‹åŒ–å†™æ—¥è®°è¡¨å•
function initWriteForm() {
    const contentTextarea = document.getElementById('entry-content');
    const wordCountSpan = document.getElementById('word-count');
    
    if (contentTextarea && wordCountSpan) {
        contentTextarea.addEventListener('input', function() {
            const wordCount = this.value.length;
            wordCountSpan.textContent = wordCount;
        });
    }
    
    // è®¾ç½®é»˜è®¤æ—¥æœŸå’Œå­•å‘¨
    const today = new Date().toISOString().split('T')[0];
    const dateInput = document.getElementById('entry-date');
    const weekInput = document.getElementById('entry-week');
    
    if (dateInput) dateInput.value = today;
    if (weekInput) weekInput.value = calculateCurrentWeek();
}

// ç­›é€‰æ—¥è®°æ¡ç›®
function filterEntries(filter) {
    const entries = document.querySelectorAll('.diary-entry');
    
    entries.forEach(entry => {
        if (filter === 'all') {
            entry.style.display = 'block';
        } else if (filter === 'favorite') {
            const isFavorite = entry.querySelector('.action-btn.favorite.active');
            entry.style.display = isFavorite ? 'block' : 'none';
        } else {
            const category = entry.dataset.category;
            entry.style.display = category === filter ? 'block' : 'none';
        }
    });
    
    showNotification(`æ­£åœ¨æ˜¾ç¤º${getFilterName(filter)}`, 'info');
}

// è·å–ç­›é€‰å™¨åç§°
function getFilterName(filter) {
    const names = {
        'all': 'å…¨éƒ¨æ—¥è®°',
        'mood': 'å¿ƒæƒ…è®°å½•',
        'checkup': 'äº§æ£€æ—¥è®°',
        'milestone': 'é‡Œç¨‹ç¢‘',
        'daily': 'æ—¥å¸¸ç”Ÿæ´»',
        'favorite': 'æ”¶è—æ—¥è®°'
    };
    return names[filter] || 'æ—¥è®°';
}

// æœç´¢æ—¥è®°æ¡ç›®
function searchEntries(query) {
    const entries = document.querySelectorAll('.diary-entry');
    const searchTerm = query.toLowerCase().trim();
    
    if (!searchTerm) {
        entries.forEach(entry => entry.style.display = 'block');
        return;
    }
    
    entries.forEach(entry => {
        const title = entry.querySelector('.entry-title').textContent.toLowerCase();
        const excerpt = entry.querySelector('.entry-excerpt').textContent.toLowerCase();
        const tags = Array.from(entry.querySelectorAll('.tag')).map(tag => tag.textContent.toLowerCase()).join(' ');
        
        const isMatch = title.includes(searchTerm) || excerpt.includes(searchTerm) || tags.includes(searchTerm);
        entry.style.display = isMatch ? 'block' : 'none';
    });
}

// æ’åºæ—¥è®°æ¡ç›®
function sortEntries(sortType) {
    const grid = document.getElementById('diary-grid');
    const entries = Array.from(grid.querySelectorAll('.diary-entry'));
    
    entries.sort((a, b) => {
        switch (sortType) {
            case 'date-desc':
                return new Date(b.dataset.date) - new Date(a.dataset.date);
            case 'date-asc':
                return new Date(a.dataset.date) - new Date(b.dataset.date);
            case 'words-desc':
                return parseInt(b.dataset.words) - parseInt(a.dataset.words);
            case 'words-asc':
                return parseInt(a.dataset.words) - parseInt(b.dataset.words);
            default:
                return 0;
        }
    });
    
    // é‡æ–°æ’åˆ—DOMå…ƒç´ 
    entries.forEach(entry => grid.appendChild(entry));
    
    showNotification('æ—¥è®°å·²é‡æ–°æ’åº', 'info');
}

// åˆ‡æ¢è§†å›¾
function switchView(view) {
    const grid = document.getElementById('diary-grid');
    
    if (view === 'list') {
        grid.style.gridTemplateColumns = '1fr';
        grid.querySelectorAll('.diary-entry').forEach(entry => {
            entry.style.display = 'flex';
            entry.style.flexDirection = 'row';
            entry.style.alignItems = 'center';
        });
    } else {
        grid.style.gridTemplateColumns = 'repeat(auto-fill, minmax(400px, 1fr))';
        grid.querySelectorAll('.diary-entry').forEach(entry => {
            entry.style.display = 'block';
            entry.style.flexDirection = '';
            entry.style.alignItems = '';
        });
    }
}

// åˆ‡æ¢æ”¶è—çŠ¶æ€
function toggleFavorite(btn) {
    const entry = btn.closest('.diary-entry');
    const icon = btn.querySelector('.action-icon');
    
    if (btn.classList.contains('active')) {
        btn.classList.remove('active');
        icon.textContent = 'ğŸ¤';
        showNotification('å·²å–æ¶ˆæ”¶è—', 'info');
    } else {
        btn.classList.add('active');
        icon.textContent = 'â¤ï¸';
        showNotification('å·²æ·»åŠ åˆ°æ”¶è—', 'success');
    }
    
    updateDiaryStats();
}

// åˆ†äº«æ—¥è®°
function shareEntry(btn) {
    const entry = btn.closest('.diary-entry');
    const title = entry.querySelector('.entry-title').textContent;
    const excerpt = entry.querySelector('.entry-excerpt').textContent;
    
    if (navigator.share) {
        navigator.share({
            title: title,
            text: excerpt.substring(0, 100) + '...',
            url: window.location.href
        }).then(() => {
            showNotification('åˆ†äº«æˆåŠŸ', 'success');
        }).catch(() => {
            copyToClipboard(window.location.href);
        });
    } else {
        copyToClipboard(window.location.href);
    }
}

// æ˜¾ç¤ºæ¡ç›®èœå•
function showEntryMenu(btn) {
    const menu = document.createElement('div');
    menu.className = 'entry-menu';
    menu.innerHTML = `
        <div class="menu-item" onclick="editEntry(this)">âœï¸ ç¼–è¾‘</div>
        <div class="menu-item" onclick="deleteEntry(this)">ğŸ—‘ï¸ åˆ é™¤</div>
        <div class="menu-item" onclick="duplicateEntry(this)">ğŸ“‹ å¤åˆ¶</div>
    `;
    
    const style = document.createElement('style');
    style.textContent = `
        .entry-menu {
            position: absolute;
            background: white;
            border-radius: 10px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border: 1px solid #f0f0f0;
            z-index: 1000;
            min-width: 120px;
        }
        .menu-item {
            padding: 12px 15px;
            cursor: pointer;
            transition: background 0.3s ease;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .menu-item:hover {
            background: #f8f9fa;
        }
        .menu-item:first-child {
            border-radius: 10px 10px 0 0;
        }
        .menu-item:last-child {
            border-radius: 0 0 10px 10px;
        }
    `;
    
    document.head.appendChild(style);
    
    // å®šä½èœå•
    const rect = btn.getBoundingClientRect();
    menu.style.position = 'fixed';
    menu.style.top = rect.bottom + 5 + 'px';
    menu.style.left = rect.left - 80 + 'px';
    
    document.body.appendChild(menu);
    
    // ç‚¹å‡»å¤–éƒ¨å…³é—­èœå•
    setTimeout(() => {
        document.addEventListener('click', function closeMenu(e) {
            if (!menu.contains(e.target)) {
                menu.remove();
                document.removeEventListener('click', closeMenu);
            }
        });
    }, 10);
}

// ç¼–è¾‘æ—¥è®°
function editEntry(menuItem) {
    const menu = menuItem.closest('.entry-menu');
    menu.remove();
    showNotification('ç¼–è¾‘åŠŸèƒ½å¼€å‘ä¸­...', 'info');
}

// åˆ é™¤æ—¥è®°
function deleteEntry(menuItem) {
    const menu = menuItem.closest('.entry-menu');
    menu.remove();
    
    if (confirm('ç¡®å®šè¦åˆ é™¤è¿™ç¯‡æ—¥è®°å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
        showNotification('æ—¥è®°å·²åˆ é™¤', 'success');
        updateDiaryStats();
    }
}

// å¤åˆ¶æ—¥è®°
function duplicateEntry(menuItem) {
    const menu = menuItem.closest('.entry-menu');
    menu.remove();
    showNotification('æ—¥è®°å·²å¤åˆ¶åˆ°è‰ç¨¿', 'success');
}

// æ˜¾ç¤ºå†™æ—¥è®°æ¨¡æ€æ¡†
function showWriteModal() {
    const modal = document.getElementById('write-modal');
    modal.style.display = 'flex';
    
    setTimeout(() => {
        modal.classList.add('show');
    }, 10);
    
    // èšç„¦åˆ°æ ‡é¢˜è¾“å…¥æ¡†
    const titleInput = document.getElementById('entry-title');
    if (titleInput) {
        setTimeout(() => titleInput.focus(), 300);
    }
}

// å…³é—­å†™æ—¥è®°æ¨¡æ€æ¡†
function closeWriteModal() {
    const modal = document.getElementById('write-modal');
    modal.classList.remove('show');
    
    setTimeout(() => {
        modal.style.display = 'none';
        resetWriteForm();
    }, 300);
}

// é‡ç½®å†™æ—¥è®°è¡¨å•
function resetWriteForm() {
    const form = document.getElementById('write-form');
    if (form) {
        form.reset();
        
        // é‡æ–°è®¾ç½®é»˜è®¤å€¼
        const today = new Date().toISOString().split('T')[0];
        const dateInput = document.getElementById('entry-date');
        const weekInput = document.getElementById('entry-week');
        const wordCountSpan = document.getElementById('word-count');
        
        if (dateInput) dateInput.value = today;
        if (weekInput) weekInput.value = calculateCurrentWeek();
        if (wordCountSpan) wordCountSpan.textContent = '0';
    }
}

// ä¿å­˜è‰ç¨¿
function saveDraft() {
    const title = document.getElementById('entry-title').value;
    
    if (!title.trim()) {
        showNotification('è¯·è¾“å…¥æ—¥è®°æ ‡é¢˜', 'error');
        return;
    }
    
    showNotification('è‰ç¨¿å·²ä¿å­˜', 'success');
}

// æäº¤æ—¥è®°
function submitEntry() {
    const title = document.getElementById('entry-title').value;
    const content = document.getElementById('entry-content').value;
    const date = document.getElementById('entry-date').value;
    const category = document.getElementById('entry-category').value;
    
    if (!title.trim()) {
        showNotification('è¯·è¾“å…¥æ—¥è®°æ ‡é¢˜', 'error');
        return;
    }
    
    if (!content.trim()) {
        showNotification('è¯·è¾“å…¥æ—¥è®°å†…å®¹', 'error');
        return;
    }
    
    if (!date) {
        showNotification('è¯·é€‰æ‹©æ—¥æœŸ', 'error');
        return;
    }
    
    // æ¨¡æ‹Ÿæäº¤è¿‡ç¨‹
    const submitBtn = document.querySelector('.form-btn.submit');
    const originalText = submitBtn.textContent;
    
    submitBtn.textContent = 'å‘å¸ƒä¸­...';
    submitBtn.disabled = true;
    
    setTimeout(() => {
        showNotification('æ—¥è®°å‘å¸ƒæˆåŠŸï¼', 'success');
        closeWriteModal();
        
        // é‡ç½®æŒ‰é’®
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
        
        // æ›´æ–°ç»Ÿè®¡
        updateDiaryStats();
    }, 2000);
}

// åŠ è½½æ›´å¤šæ—¥è®°
function loadMoreEntries() {
    const loadBtn = document.querySelector('.load-more-btn');
    const originalText = loadBtn.querySelector('.load-text').textContent;
    
    loadBtn.querySelector('.load-text').textContent = 'åŠ è½½ä¸­...';
    loadBtn.disabled = true;
    
    setTimeout(() => {
        showNotification('å·²åŠ è½½æ›´å¤šæ—¥è®°', 'success');
        
        loadBtn.querySelector('.load-text').textContent = originalText;
        loadBtn.disabled = false;
    }, 1500);
}

// æ›´æ–°æ—¥è®°ç»Ÿè®¡
function updateDiaryStats() {
    const entries = document.querySelectorAll('.diary-entry');
    const favoriteEntries = document.querySelectorAll('.diary-entry .action-btn.favorite.active');
    
    // è®¡ç®—æ€»å­—æ•°
    let totalWords = 0;
    entries.forEach(entry => {
        totalWords += parseInt(entry.dataset.words) || 0;
    });
    
    // è®¡ç®—è®°å½•å¤©æ•°ï¼ˆå»é‡æ—¥æœŸï¼‰
    const uniqueDates = new Set();
    entries.forEach(entry => {
        uniqueDates.add(entry.dataset.date);
    });
    
    // æ›´æ–°ç»Ÿè®¡æ•°å­—
    animateNumber('total-entries', entries.length);
    animateNumber('total-words', totalWords);
    animateNumber('favorite-entries', favoriteEntries.length);
    animateNumber('writing-days', uniqueDates.size);
}

// æ•°å­—åŠ¨ç”»
function animateNumber(elementId, targetNumber) {
    const element = document.getElementById(elementId);
    if (!element) return;
    
    const startNumber = parseInt(element.textContent.replace(/,/g, '')) || 0;
    const duration = 1000;
    const startTime = Date.now();
    
    function updateNumber() {
        const elapsed = Date.now() - startTime;
        const progress = Math.min(elapsed / duration, 1);
        
        const currentNumber = Math.floor(startNumber + (targetNumber - startNumber) * progress);
        element.textContent = currentNumber.toLocaleString();
        
        if (progress < 1) {
            requestAnimationFrame(updateNumber);
        }
    }
    
    updateNumber();
}

// è§‚å¯Ÿæ—¥è®°æ¡ç›®ï¼ˆå…¥åœºåŠ¨ç”»ï¼‰
function observeDiaryEntries() {
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    });
    
    // åˆå§‹åŒ–æ ·å¼å¹¶è§‚å¯Ÿ
    document.querySelectorAll('.diary-entry').forEach((entry, index) => {
        entry.style.opacity = '0';
        entry.style.transform = 'translateY(30px)';
        entry.style.transition = `opacity 0.6s ease ${index * 0.1}s, transform 0.6s ease ${index * 0.1}s`;
        observer.observe(entry);
    });
}

// è®¡ç®—å½“å‰å­•å‘¨
function calculateCurrentWeek() {
    const pregnancyStart = new Date('2023-08-15'); // ä»é…ç½®ä¸­è·å–
    const today = new Date();
    const diffTime = Math.abs(today - pregnancyStart);
    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    const weeks = Math.floor(diffDays / 7);
    return Math.min(weeks, 42);
}

// å¤åˆ¶åˆ°å‰ªè´´æ¿
function copyToClipboard(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text).then(() => {
            showNotification('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
        }).catch(() => {
            fallbackCopyToClipboard(text);
        });
    } else {
        fallbackCopyToClipboard(text);
    }
}

// å¤‡ç”¨å¤åˆ¶æ–¹æ³•
function fallbackCopyToClipboard(text) {
    const textArea = document.createElement('textarea');
    textArea.value = text;
    textArea.style.position = 'fixed';
    textArea.style.left = '-999999px';
    textArea.style.top = '-999999px';
    document.body.appendChild(textArea);
    textArea.focus();
    textArea.select();
    
    try {
        document.execCommand('copy');
        showNotification('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
    } catch (err) {
        showNotification('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', 'error');
    }
    
    document.body.removeChild(textArea);
}

// æ˜¾ç¤ºé€šçŸ¥æ¶ˆæ¯
function showNotification(message, type = 'info') {
    // ç§»é™¤ç°æœ‰é€šçŸ¥
    const existingNotification = document.querySelector('.notification');
    if (existingNotification) {
        existingNotification.remove();
    }
    
    // åˆ›å»ºé€šçŸ¥å…ƒç´ 
    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.textContent = message;
    
    // æ·»åŠ æ ·å¼
    const style = document.createElement('style');
    style.textContent = `
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-weight: 500;
            z-index: 10001;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        .notification.info {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        .notification.success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }
        .notification.error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        .notification.warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        .notification.show {
            transform: translateX(0);
        }
    `;
    
    if (!document.querySelector('style[data-notification]')) {
        style.setAttribute('data-notification', 'true');
        document.head.appendChild(style);
    }
    
    // æ·»åŠ åˆ°é¡µé¢
    document.body.appendChild(notification);
    
    // æ˜¾ç¤ºåŠ¨ç”»
    setTimeout(() => {
        notification.classList.add('show');
    }, 10);
    
    // è‡ªåŠ¨éšè—
    setTimeout(() => {
        notification.classList.remove('show');
        setTimeout(() => {
            notification.remove();
        }, 300);
    }, 3000);
}

// é”®ç›˜å¿«æ·é”®
document.addEventListener('keydown', function(e) {
    // Ctrl/Cmd + N: æ–°å»ºæ—¥è®°
    if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
        e.preventDefault();
        showWriteModal();
    }
    
    // ESC: å…³é—­æ¨¡æ€æ¡†
    if (e.key === 'Escape') {
        const modal = document.getElementById('write-modal');
        if (modal && modal.style.display !== 'none') {
            closeWriteModal();
        }
    }
});

// ç‚¹å‡»æ—¥è®°æ¡ç›®æŸ¥çœ‹è¯¦æƒ…
document.addEventListener('click', function(e) {
    const entry = e.target.closest('.diary-entry');
    if (entry && !e.target.closest('.entry-actions') && !e.target.closest('.action-btn')) {
        const title = entry.querySelector('.entry-title').textContent;
        showNotification(`æ­£åœ¨æŸ¥çœ‹ã€Š${title}ã€‹`, 'info');
        // è¿™é‡Œå¯ä»¥è·³è½¬åˆ°è¯¦æƒ…é¡µé¢æˆ–æ˜¾ç¤ºè¯¦æƒ…æ¨¡æ€æ¡†
    }
});
</script>